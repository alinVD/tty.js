!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.tty=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={"default":a("core-js/library/fn/map"),__esModule:!0}},{"core-js/library/fn/map":11}],2:[function(a,b,c){b.exports={"default":a("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":12}],3:[function(a,b,c){b.exports={"default":a("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":13}],4:[function(a,b,c){b.exports={"default":a("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":14}],5:[function(a,b,c){b.exports={"default":a("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":15}],6:[function(a,b,c){"use strict";c["default"]=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},c.__esModule=!0},{}],7:[function(a,b,c){"use strict";var d=a("babel-runtime/core-js/object/define-property")["default"];c["default"]=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),d(a,e.key,e)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),c.__esModule=!0},{"babel-runtime/core-js/object/define-property":3}],8:[function(a,b,c){"use strict";var d=a("babel-runtime/core-js/object/get-own-property-descriptor")["default"];c["default"]=function(a,b,c){for(var e=!0;e;){var f=a,g=b,h=c;i=k=j=void 0,e=!1;var i=d(f,g);if(void 0!==i){if("value"in i)return i.value;var j=i.get;return void 0===j?void 0:j.call(h)}var k=Object.getPrototypeOf(f);if(null===k)return void 0;a=k,b=g,c=h,e=!0}},c.__esModule=!0},{"babel-runtime/core-js/object/get-own-property-descriptor":4}],9:[function(a,b,c){"use strict";var d=a("babel-runtime/core-js/object/create")["default"];c["default"]=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=d(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},c.__esModule=!0},{"babel-runtime/core-js/object/create":2}],10:[function(a,b,c){"use strict";c["default"]=function(a){return a&&a.__esModule?a:{"default":a}},c.__esModule=!0},{}],11:[function(a,b,c){a("../modules/es6.object.to-string"),a("../modules/es6.string.iterator"),a("../modules/web.dom.iterable"),a("../modules/es6.map"),a("../modules/es7.map.to-json"),b.exports=a("../modules/$").core.Map},{"../modules/$":29,"../modules/es6.map":38,"../modules/es6.object.to-string":40,"../modules/es6.string.iterator":41,"../modules/es7.map.to-json":42,"../modules/web.dom.iterable":43}],12:[function(a,b,c){var d=a("../../modules/$");b.exports=function(a,b){return d.create(a,b)}},{"../../modules/$":29}],13:[function(a,b,c){var d=a("../../modules/$");b.exports=function(a,b,c){return d.setDesc(a,b,c)}},{"../../modules/$":29}],14:[function(a,b,c){var d=a("../../modules/$");a("../../modules/es6.object.statics-accept-primitives"),b.exports=function(a,b){return d.getDesc(a,b)}},{"../../modules/$":29,"../../modules/es6.object.statics-accept-primitives":39}],15:[function(a,b,c){a("../../modules/es6.object.statics-accept-primitives"),b.exports=a("../../modules/$").core.Object.keys},{"../../modules/$":29,"../../modules/es6.object.statics-accept-primitives":39}],16:[function(a,b,c){function d(a,b,c){if(!a)throw TypeError(c?b+c:b)}var e=a("./$");d.def=e.assertDefined,d.fn=function(a){if(!e.isFunction(a))throw TypeError(a+" is not a function!");return a},d.obj=function(a){if(!e.isObject(a))throw TypeError(a+" is not an object!");return a},d.inst=function(a,b,c){if(!(a instanceof b))throw TypeError(c+": use the 'new' operator!");return a},b.exports=d},{"./$":29}],17:[function(a,b,c){function d(a){return g.call(a).slice(8,-1)}var e=a("./$"),f=a("./$.wks")("toStringTag"),g={}.toString;d.classof=function(a){var b,c;return void 0==a?void 0===a?"Undefined":"Null":"string"==typeof(c=(b=Object(a))[f])?c:d(b)},d.set=function(a,b,c){a&&!e.has(a=c?a:a.prototype,f)&&e.hide(a,f,b)},b.exports=d},{"./$":29,"./$.wks":36}],18:[function(a,b,c){"use strict";function d(a,b){if(!n(a))return("string"==typeof a?"S":"P")+a;if(!l(a,q)){if(!p(a))return"F";if(!b)return"E";o(a,q,++w)}return"O"+a[q]}function e(a,b){var c,e=d(b);if("F"!=e)return a[r][e];for(c=a[t];c;c=c.n)if(c.k==b)return c}var f=a("./$"),g=a("./$.ctx"),h=a("./$.uid").safe,i=a("./$.assert"),j=a("./$.for-of"),k=a("./$.iter").step,l=f.has,m=f.set,n=f.isObject,o=f.hide,p=Object.isExtensible||n,q=h("id"),r=h("O1"),s=h("last"),t=h("first"),u=h("iter"),v=f.DESC?h("size"):"size",w=0;b.exports={getConstructor:function(b,c,d){function h(){var a=i.inst(this,h,b),e=arguments[0];m(a,r,f.create(null)),m(a,v,0),m(a,s,void 0),m(a,t,void 0),void 0!=e&&j(e,c,a[d],a)}return a("./$.mix")(h.prototype,{clear:function(){for(var a=this,b=a[r],c=a[t];c;c=c.n)c.r=!0,c.p&&(c.p=c.p.n=void 0),delete b[c.i];a[t]=a[s]=void 0,a[v]=0},"delete":function(a){var b=this,c=e(b,a);if(c){var d=c.n,f=c.p;delete b[r][c.i],c.r=!0,f&&(f.n=d),d&&(d.p=f),b[t]==c&&(b[t]=d),b[s]==c&&(b[s]=f),b[v]--}return!!c},forEach:function(a){for(var b,c=g(a,arguments[1],3);b=b?b.n:this[t];)for(c(b.v,b.k,this);b&&b.r;)b=b.p},has:function(a){return!!e(this,a)}}),f.DESC&&f.setDesc(h.prototype,"size",{get:function(){return i.def(this[v])}}),h},def:function(a,b,c){var f,g,h=e(a,b);return h?h.v=c:(a[s]=h={i:g=d(b,!0),k:b,v:c,p:f=a[s],n:void 0,r:!1},a[t]||(a[t]=h),f&&(f.n=h),a[v]++,"F"!=g&&(a[r][g]=h)),a},getEntry:e,setIter:function(b,c,d){a("./$.iter-define")(b,c,function(a,b){m(this,u,{o:a,k:b})},function(){for(var a=this[u],b=a.k,c=a.l;c&&c.r;)c=c.p;return a.o&&(a.l=c=c?c.n:a.o[t])?"keys"==b?k(0,c.k):"values"==b?k(0,c.v):k(0,[c.k,c.v]):(a.o=void 0,k(1))},d?"entries":"values",!d,!0)}}},{"./$":29,"./$.assert":16,"./$.ctx":21,"./$.for-of":23,"./$.iter":28,"./$.iter-define":26,"./$.mix":30,"./$.uid":34}],19:[function(a,b,c){var d=a("./$.def"),e=a("./$.for-of");b.exports=function(a){d(d.P,a,{toJSON:function(){var a=[];return e(this,!1,a.push,a),a}})}},{"./$.def":22,"./$.for-of":23}],20:[function(a,b,c){"use strict";var d=a("./$"),e=a("./$.def"),f=a("./$.iter").BUGGY,g=a("./$.for-of"),h=a("./$.species"),i=a("./$.assert").inst;b.exports=function(b,c,j,k,l){function m(b,c){if(d.FW){var e=q[b];a("./$.redef")(q,b,function(a,b){var d=e.call(this,0===a?0:a,b);return c?this:d})}}var n=d.g[b],o=n,p=k?"set":"add",q=o&&o.prototype,r={};if(d.isFunction(o)&&(l||!f&&q.forEach&&q.entries)){var s,t=new o,u=t[p](l?{}:-0,1);a("./$.iter-detect")(function(a){new o(a)})||(o=function(){i(this,o,b);var a=new n,c=arguments[0];return void 0!=c&&g(c,k,a[p],a),a},o.prototype=q,d.FW&&(q.constructor=o)),l||t.forEach(function(a,b){s=1/b===-(1/0)}),s&&(m("delete"),m("has"),k&&m("get")),(s||u!==t)&&m(p,!0)}else o=j.getConstructor(b,k,p),a("./$.mix")(o.prototype,c);return a("./$.cof").set(o,b),r[b]=o,e(e.G+e.W+e.F*(o!=n),r),h(o),h(d.core[b]),l||j.setIter(o,b,k),o}},{"./$":29,"./$.assert":16,"./$.cof":17,"./$.def":22,"./$.for-of":23,"./$.iter":28,"./$.iter-detect":27,"./$.mix":30,"./$.redef":31,"./$.species":32}],21:[function(a,b,c){var d=a("./$.assert").fn;b.exports=function(a,b,c){if(d(a),~c&&void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./$.assert":16}],22:[function(a,b,c){function d(a,b){return function(){return a.apply(b,arguments)}}function e(a,b,c){var f,j,k,l,m=a&e.G,n=a&e.P,o=m?g:a&e.S?g[b]:(g[b]||{}).prototype,p=m?h:h[b]||(h[b]={});m&&(c=b);for(f in c)j=!(a&e.F)&&o&&f in o,j&&f in p||(k=j?o[f]:c[f],m&&!i(o[f])?l=c[f]:a&e.B&&j?l=d(k,g):a&e.W&&o[f]==k?!function(a){l=function(b){return this instanceof a?new a(b):a(b)},l.prototype=a.prototype}(k):l=n&&i(k)?d(Function.call,k):k,p[f]=l,n&&((p.prototype||(p.prototype={}))[f]=k))}var f=a("./$"),g=f.g,h=f.core,i=f.isFunction;e.F=1,e.G=2,e.S=4,e.P=8,e.B=16,e.W=32,b.exports=e},{"./$":29}],23:[function(a,b,c){var d=a("./$.ctx"),e=a("./$.iter").get,f=a("./$.iter-call");b.exports=function(a,b,c,g){for(var h,i=e(a),j=d(c,g,b?2:1);!(h=i.next()).done;)if(f(i,j,h.value,b)===!1)return f.close(i)}},{"./$.ctx":21,"./$.iter":28,"./$.iter-call":25}],24:[function(a,b,c){b.exports=function(a){return a.FW=!1,a.path=a.core,a}},{}],25:[function(a,b,c){function d(a){var b=a["return"];void 0!==b&&f(b.call(a))}function e(a,b,c,e){try{return e?b(f(c)[0],c[1]):b(c)}catch(g){throw d(a),g}}var f=a("./$.assert").obj;e.close=d,b.exports=e},{"./$.assert":16}],26:[function(a,b,c){var d=a("./$.def"),e=a("./$.redef"),f=a("./$"),g=a("./$.cof"),h=a("./$.iter"),i=a("./$.wks")("iterator"),j="@@iterator",k="keys",l="values",m=h.Iterators;b.exports=function(a,b,c,n,o,p,q){function r(a){function b(b){return new c(b,a)}switch(a){case k:return function(){return b(this)};case l:return function(){return b(this)}}return function(){return b(this)}}h.create(c,b,n);var s,t,u=b+" Iterator",v=a.prototype,w=v[i]||v[j]||o&&v[o],x=w||r(o);if(w){var y=f.getProto(x.call(new a));g.set(y,u,!0),f.FW&&f.has(v,j)&&h.set(y,f.that)}if(f.FW&&h.set(v,x),m[b]=x,m[u]=f.that,o)if(s={keys:p?x:r(k),values:o==l?x:r(l),entries:o!=l?x:r("entries")},q)for(t in s)t in v||e(v,t,s[t]);else d(d.P+d.F*h.BUGGY,b,s)}},{"./$":29,"./$.cof":17,"./$.def":22,"./$.iter":28,"./$.redef":31,"./$.wks":36}],27:[function(a,b,c){var d=a("./$.wks")("iterator"),e=!1;try{var f=[7][d]();f["return"]=function(){e=!0},Array.from(f,function(){throw 2})}catch(g){}b.exports=function(a){if(!e)return!1;var b=!1;try{var c=[7],f=c[d]();f.next=function(){b=!0},c[d]=function(){return f},a(c)}catch(g){}return b}},{"./$.wks":36}],28:[function(a,b,c){"use strict";function d(a,b){e.hide(a,h,b),i in[]&&e.hide(a,i,b)}var e=a("./$"),f=a("./$.cof"),g=a("./$.assert").obj,h=a("./$.wks")("iterator"),i="@@iterator",j={},k={};d(k,e.that),b.exports={BUGGY:"keys"in[]&&!("next"in[].keys()),Iterators:j,step:function(a,b){return{value:b,done:!!a}},is:function(a){var b=Object(a),c=e.g.Symbol,d=c&&c.iterator||i;return d in b||h in b||e.has(j,f.classof(b))},get:function(a){var b=e.g.Symbol,c=a[b&&b.iterator||i],d=c||a[h]||j[f.classof(a)];return g(d.call(a))},set:d,create:function(a,b,c,d){a.prototype=e.create(d||k,{next:e.desc(1,c)}),f.set(a,b+" Iterator")}}},{"./$":29,"./$.assert":16,"./$.cof":17,"./$.wks":36}],29:[function(a,b,c){"use strict";function d(a){return isNaN(a=+a)?0:(a>0?p:o)(a)}function e(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}function f(a,b,c){return a[b]=c,a}function g(a){return s?function(b,c,d){return u.setDesc(b,c,e(a,d))}:f}function h(a){return null!==a&&("object"==typeof a||"function"==typeof a)}function i(a){return"function"==typeof a}function j(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}var k="undefined"!=typeof self?self:Function("return this")(),l={},m=Object.defineProperty,n={}.hasOwnProperty,o=Math.ceil,p=Math.floor,q=Math.max,r=Math.min,s=!!function(){try{return 2==m({},"a",{get:function(){return 2}}).a}catch(a){}}(),t=g(1),u=b.exports=a("./$.fw")({g:k,core:l,html:k.document&&document.documentElement,isObject:h,isFunction:i,it:function(a){return a},that:function(){return this},toInteger:d,toLength:function(a){return a>0?r(d(a),9007199254740991):0},toIndex:function(a,b){return a=d(a),0>a?q(a+b,0):r(a,b)},has:function(a,b){return n.call(a,b)},create:Object.create,getProto:Object.getPrototypeOf,DESC:s,desc:e,getDesc:Object.getOwnPropertyDescriptor,setDesc:m,setDescs:Object.defineProperties,getKeys:Object.keys,getNames:Object.getOwnPropertyNames,getSymbols:Object.getOwnPropertySymbols,assertDefined:j,ES5Object:Object,toObject:function(a){return u.ES5Object(j(a))},hide:t,def:g(0),set:k.Symbol?f:t,each:[].forEach});"undefined"!=typeof __e&&(__e=l),"undefined"!=typeof __g&&(__g=k)},{"./$.fw":24}],30:[function(a,b,c){var d=a("./$.redef");b.exports=function(a,b){for(var c in b)d(a,c,b[c]);return a}},{"./$.redef":31}],31:[function(a,b,c){b.exports=a("./$").hide},{"./$":29}],32:[function(a,b,c){var d=a("./$"),e=a("./$.wks")("species");b.exports=function(a){!d.DESC||e in a||d.setDesc(a,e,{configurable:!0,get:d.that})}},{"./$":29,"./$.wks":36}],33:[function(a,b,c){var d=a("./$");b.exports=function(a){return function(b,c){var e,f,g=String(d.assertDefined(b)),h=d.toInteger(c),i=g.length;return 0>h||h>=i?a?"":void 0:(e=g.charCodeAt(h),55296>e||e>56319||h+1===i||(f=g.charCodeAt(h+1))<56320||f>57343?a?g.charAt(h):e:a?g.slice(h,h+2):(e-55296<<10)+(f-56320)+65536)}}},{"./$":29}],34:[function(a,b,c){function d(a){return"Symbol(".concat(void 0===a?"":a,")_",(++e+Math.random()).toString(36))}var e=0;d.safe=a("./$").g.Symbol||d,b.exports=d},{"./$":29}],35:[function(a,b,c){var d=a("./$"),e=a("./$.wks")("unscopables");!d.FW||e in[]||d.hide(Array.prototype,e,{}),b.exports=function(a){d.FW&&([][e][a]=!0)}},{"./$":29,"./$.wks":36}],36:[function(a,b,c){var d=a("./$").g,e={};b.exports=function(b){return e[b]||(e[b]=d.Symbol&&d.Symbol[b]||a("./$.uid").safe("Symbol."+b))}},{"./$":29,"./$.uid":34}],37:[function(a,b,c){var d=a("./$"),e=a("./$.unscope"),f=a("./$.uid").safe("iter"),g=a("./$.iter"),h=g.step,i=g.Iterators;a("./$.iter-define")(Array,"Array",function(a,b){d.set(this,f,{o:d.toObject(a),i:0,k:b})},function(){var a=this[f],b=a.o,c=a.k,d=a.i++;return!b||d>=b.length?(a.o=void 0,h(1)):"keys"==c?h(0,d):"values"==c?h(0,b[d]):h(0,[d,b[d]])},"values"),i.Arguments=i.Array,e("keys"),e("values"),e("entries")},{"./$":29,"./$.iter":28,"./$.iter-define":26,"./$.uid":34,"./$.unscope":35}],38:[function(a,b,c){"use strict";var d=a("./$.collection-strong");a("./$.collection")("Map",{get:function(a){var b=d.getEntry(this,a);return b&&b.v},set:function(a,b){return d.def(this,0===a?0:a,b)}},d,!0)},{"./$.collection":20,"./$.collection-strong":18}],39:[function(a,b,c){var d=a("./$"),e=a("./$.def"),f=d.isObject,g=d.toObject;d.each.call("freeze,seal,preventExtensions,isFrozen,isSealed,isExtensible,getOwnPropertyDescriptor,getPrototypeOf,keys,getOwnPropertyNames".split(","),function(a,b){var c=(d.core.Object||{})[a]||Object[a],h=0,i={};i[a]=0==b?function(a){return f(a)?c(a):a}:1==b?function(a){return f(a)?c(a):a}:2==b?function(a){return f(a)?c(a):a}:3==b?function(a){return f(a)?c(a):!0}:4==b?function(a){return f(a)?c(a):!0}:5==b?function(a){return f(a)?c(a):!1}:6==b?function(a,b){return c(g(a),b)}:7==b?function(a){return c(Object(d.assertDefined(a)))}:8==b?function(a){return c(g(a))}:function(a){return c(g(a))};try{c("z")}catch(j){h=1}e(e.S+e.F*h,"Object",i)})},{"./$":29,"./$.def":22}],40:[function(a,b,c){"use strict";var d=a("./$.cof"),e={};e[a("./$.wks")("toStringTag")]="z",a("./$").FW&&"z"!=d(e)&&a("./$.redef")(Object.prototype,"toString",function(){return"[object "+d.classof(this)+"]"},!0)},{"./$":29,"./$.cof":17,"./$.redef":31,"./$.wks":36}],41:[function(a,b,c){var d=a("./$").set,e=a("./$.string-at")(!0),f=a("./$.uid").safe("iter"),g=a("./$.iter"),h=g.step;a("./$.iter-define")(String,"String",function(a){d(this,f,{o:String(a),i:0})},function(){var a,b=this[f],c=b.o,d=b.i;return d>=c.length?h(1):(a=e(c,d),b.i+=a.length,h(0,a))})},{"./$":29,"./$.iter":28,"./$.iter-define":26,"./$.string-at":33,"./$.uid":34}],42:[function(a,b,c){a("./$.collection-to-json")("Map")},{"./$.collection-to-json":19}],43:[function(a,b,c){a("./es6.array.iterator");var d=a("./$"),e=a("./$.iter").Iterators,f=a("./$.wks")("iterator"),g=e.Array,h=d.g.NodeList;!d.FW||!h||f in h.prototype||d.hide(h.prototype,f,g),e.NodeList=g},{"./$":29,"./$.iter":28,"./$.wks":36,"./es6.array.iterator":37}],44:[function(a,b,c){"use strict";var d=a("babel-runtime/core-js/object/define-property")["default"],e=a("babel-runtime/helpers/interop-require-default")["default"];d(c,"__esModule",{value:!0});var f=a("./window"),g=e(f),h=a("./tab"),i=e(h),j=a("./tty"),k=e(j);c.Window=g["default"],c.Tab=i["default"],c.TTY=k["default"]},{"./tab":45,"./tty":46,"./window":48,"babel-runtime/core-js/object/define-property":3,"babel-runtime/helpers/interop-require-default":10}],45:[function(a,b,c){"use strict";function d(a,b,c){var d=this,e=a.cols,g=a.rows;Terminal.call(this,{cols:e,rows:g});var h=document.creatElement("div");h.className="tab",h.innerHTML="•",f.on(h,"click",function(a){return a.ctrlKey||a.altKey||a.metaKey||a.shiftKey?d.destroy():d.focus(),f.cancel(a)}),this.socket=b,this.window=a,this.session=a.session,this.button=h,this.element=null,this.open(),this.hookKeys(),c?(this.id=c.id,this.pty=c.pty,this.setProcessName(c.process),this._resize(c.cols,c.rows)):(this.id="",this.process="",this.socket.emit("create",this.session,e,g,function(a,b){return a?d._destroy():(d.pty=b.pty,d.id=b.id,d.setProcessName(b.process),void d.emit("open"))}))}var e=a("babel-runtime/core-js/object/define-property")["default"];e(c,"__esModule",{value:!0});var f=a("./utils");f.inherits(d,Terminal),d.prototype.handler=function(a){this.socket.emit("data",this.session,this.id,a)},d.prototype.handleTitle=function(a){a&&(a=f.sanitize(a),this.title=a)},d.prototype._write=d.prototype.write,d.prototype.write=function(a){return this.window.focused!==this&&(this.button.style.color="red"),this._write(a)},d.prototype._focus=d.prototype.focus,d.prototype.focus=function(){var a=this.button,b=this.window,c=this.tty;a.style.fontWeight="bold",a.style.color="",this.handleTitle(this.title),this._focus(),b.focusTab(this),this.emit("focus"),b.emit("focus tab",this),c.emit("focus tab",this)},d.prototype.unfocus=function(){var a=this.button;a.style.fontWeight=""},d.prototype._resize=d.prototype.resize,d.prototype.resize=function(a,b){var c=this.window,d=this.tty;this.socket.emit("resize",this.session,this.id,a,b),this._resize(a,b),this.emit("resize",a,b),c.emit("resize tab",this,a,b),d.emit("resize tab",this,a,b)},d.prototype.__destroy=d.prototype.destroy,d.prototype._destroy=function(){if(!this.destroyed){this.destroyed=!0;var a=this.window;this.button.parentNode.removeChild(this.button),this.element.parentNode&&this.element.parentNode.removeChild(this.element),a.removeTab(this),this.__destroy()}},d.prototype.destroy=function(){this.destroyed||(this.socket.emit("kill",this.session,this.id),this._destroy(),this.emit("close"),this.window.emit("close tab",this),this.tty.emit("close tab",this))},d.prototype.hookKeys=function(){var a=this;this.on("key",function(b){if(Terminal.focusKeys!==!1){var c,d,e=a.tty,g=e.windows;if("j"===b)c=-1;else{if("k"!==b)return;c=1}if(d=f.indexOf(a.tty.windows,a.window)+c,a._ignoreNext(),g[d])return g[d].highlight();if(c>0){if(g[0])return g[0].highlight()}else if(d=g.length-1,g[d])return g[d].highlight();return a.window.highlight()}}),this.on("request paste",function(){a.socket.emit("request paste",function(b,c){b||a.send(c)})}),this.on("request create",function(){a.window.createTab()}),this.on("request term",function(b){a.window.tabs[b]&&a.window.tabs[b].focus()}),this.on("request term next",function(){a.window.nextTab()}),this.on("request term previous",function(){a.window.previousTab()})},d.prototype._ignoreNext=function(){var a=this.handler;this.handler=function(){this.handler=a};var b=this.showCursor;this.showCursor=function(){this.showCursor=b}},d.scrollable={irssi:!0,man:!0,less:!0,htop:!0,top:!0,w3m:!0,lynx:!0,mocp:!0},d.prototype._bindMouse=d.prototype.bindMouse,d.prototype.bindMouse=function(){if(!Terminal.programFeatures)return this._bindMouse();var a=this,b="onmousewheel"in window?"mousewheel":"DOMMouseScroll";return f.on(a.element,b,function(b){return!a.mouseEvents&&d.scrollable[a.process]?("mousewheel"===b.type&&b.wheelDeltaY>0||"DOMMouseScroll"===b.type&&b.detail<0?a.keyDown({keyCode:33}):a.keyDown({keyCode:34}),f.cancel(b)):void 0}),this._bindMouse()},d.prototype.pollProcessName=function(a){var b=this;this.socket.emit("process",this.session,this.id,function(c,d){return c?a&&a(c):(b.setProcessName(d),a&&a(null,d))})},d.prototype.setProcessName=function(a){a=f.sanitize(a),this.process!==a&&this.emit("process",a),this.process=a,this.button.title=a},c["default"]=d,b.exports=c["default"]},{"./utils":47,"babel-runtime/core-js/object/define-property":3}],46:[function(a,b,c){"use strict";var d=a("babel-runtime/helpers/inherits")["default"],e=a("babel-runtime/helpers/get")["default"],f=a("babel-runtime/helpers/create-class")["default"],g=a("babel-runtime/helpers/class-call-check")["default"],h=a("babel-runtime/core-js/object/define-property")["default"],i=a("babel-runtime/core-js/map")["default"],j=a("babel-runtime/core-js/object/keys")["default"],k=a("babel-runtime/helpers/interop-require-default")["default"];h(c,"__esModule",{value:!0});var l=a("./window"),m=k(l),n=a("./utils"),o=function(a){function b(a){var c=this;g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this);var d=this.socket=a.socket;this.root=a.root,this.sessions=new i,this.windows=new i,d.on("connect",function(){c.reset(),c.emit("connect")}),d.on("session created",function(a){c.sessions.set(a.id,a),c.emit("session created",a)}),d.on("session closed",function(a){c.sessions["delete"](a),c.emit("session closed",a),c.windows.has(a)&&c.windows.get(a).destroy()}),d.on("data",function(a,b,d){c.windows.has(a)&&c.windows.get(a).write(b,d)}),d.on("kill",function(a,b){c.windows.has(a)&&c.windows.get(a).kill(b)}),d.on("sync",function(a,b){c.windows.has(a)&&c.windows.get(a).sync(b)}),a.autoPoll&&(this.poller=setInterval(function(){c.pollSessions()},a.autoPoll))}return d(b,a),f(b,[{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.poller&&(clearInterval(this.poller),delete this.poller),this.sessions.clear(),this.windows.forEach(function(a){a.destroy()}))}},{key:"reset",value:function(){this.sessions.clear(),this.windows.forEach(function(a){a.destroy()}),this.windows.clear(),this.emit("reset")}},{key:"newSession",value:function(){var a=this;this.socket.emit("new session",function(b,c){b?a.emit("error",{action:"newSession",error:b}):(a.sessions.set(c.id,c),a.newWindow(c.id))})}},{key:"newWindow",value:function(a){var b=this,c=this.sessions,d=this.windows;if(d.has(a)||!c.has(a))return null;this.socket.emit("attach",a);var e=new m["default"](this,a,this.socket);return d.set(a,e),e.once("open",function(){b.emit("open window",e)}),e.on("close",function(){d["delete"](a),b.socket.emit("detatch",a)}),e}},{key:"pollSessions",value:function(){var a=this;this.socket.emit("list sessions",function(b,c){return b?void a.emit("error",{action:"pollSessions",err:b}):(a.sessions.clear(),j(c).forEach(function(b){a.sessions.set(b,c[b])}),void a.emit("sessions list",c))})}}]),b}(n.EventEmitter);c["default"]=o,b.exports=c["default"]},{"./utils":47,"./window":48,"babel-runtime/core-js/map":1,"babel-runtime/core-js/object/define-property":3,"babel-runtime/core-js/object/keys":5,"babel-runtime/helpers/class-call-check":6,"babel-runtime/helpers/create-class":7,"babel-runtime/helpers/get":8,"babel-runtime/helpers/inherits":9,"babel-runtime/helpers/interop-require-default":10}],47:[function(a,b,c){"use strict";function d(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function e(a,b){var c=d(a,b);~c&&a.splice(c,1)}function f(a){return a?(a+"").replace(/[&<>]/g,""):""}var g=a("babel-runtime/core-js/object/define-property")["default"];g(c,"__esModule",{value:!0}),c.indexOf=d,c.splice=e,c.sanitize=f;var h=Terminal.EventEmitter;c.EventEmitter=h;var i=Terminal.inherits;c.inherits=i;var j=Terminal.on;c.on=j;var k=Terminal.off;c.off=k;var l=Terminal.cancel;c.cancel=l},{"babel-runtime/core-js/object/define-property":3}],48:[function(a,b,c){"use strict";function d(a,b,c){var d=this;i.EventEmitter.call(this);var e,g,h,j,k;e=document.createElement("div"),e.className="window",g=document.createElement("div"),g.className="grip",h=document.createElement("div"),h.className="bar",j=document.createElement("div"),j.innerHTML="~",j.title="new/close",j.className="tab",k=document.createElement("div"),k.className="title",k.innerHTML="",this.tty=a,this.session=b,this.socket=c,this.element=e,this.grip=g,this.bar=h,this.button=j,this.title=k,this.tabs=new f,this.focused=null,this.cols=Terminal.geometry[0],this.rows=Terminal.geometry[1],e.appendChild(g),e.appendChild(h),h.appendChild(j),h.appendChild(k);var l=this.createTab();this.focus(),this.bind(),l.once("open",function(){d.emit("open")})}var e=a("babel-runtime/core-js/object/define-property")["default"],f=a("babel-runtime/core-js/map")["default"],g=a("babel-runtime/core-js/object/keys")["default"],h=a("babel-runtime/helpers/interop-require-default")["default"];e(c,"__esModule",{value:!0});var i=a("./utils"),j=a("./tab"),k=h(j);i.inherits(d,i.EventEmitter),d.prototype.bind=function(){var a=this,b=this.element,c=this.bar,d=this.grip,e=this.button,f=0;i.on(e,"click",function(b){return b.ctrlKey||b.altKey||b.metaKey||b.shiftKey?a.destroy():a.createTab(),i.cancel(b)}),i.on(d,"mousedown",function(b){return a.focus(),a.resizing(b),i.cancel(b)}),i.on(b,"mousedown",function(d){if(d.target===b||d.target===c){a.focus(),i.cancel(d);var e=new Date(Date.now());return 600>e-f?a.maximize():(f=e,i.cancel(d))}})},d.prototype.focus=function(){var a=this.element.parentNode;a&&(a.removeChild(this.element),a.appendChild(this.element)),this.emit("focus")},d.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.minimize&&this.minimize(),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.each(function(a){a.destroy()}),this.emit("close"))},d.prototype.drag=function(a){function b(a){e.style.left=h.left+a.pageX-h.pageX+"px",e.style.top=h.top+a.pageY-h.pageY+"px"}function c(){e.style.opacity="",e.style.cursor="",g.style.cursor="",i.off(document,"mousemove",b),i.off(document,"mouseup",c);var a={left:e.style.left.replace(/\w+/g,""),top:e.style.top.replace(/\w+/g,"")};d.emit("drag",a)}var d=this,e=this.element,f=this.tty,g=f.root;if(!this.minimize){var h={left:e.offsetLeft,top:e.offsetTop,pageX:a.pageX,pageY:a.pageY};e.style.opacity="0.60",e.style.cursor="move",g.style.cursor="move",i.on(document,"mousemove",b),i.on(document,"mouseup",c)}},d.prototype.resizing=function(){function a(a){var b,c;c=d.offsetHeight-e.element.clientHeight,b=a.pageX-d.offsetLeft,c=a.pageY-d.offsetTop-c,d.style.width=b+"px",d.style.height=c+"px"}function b(){var f,j;f=d.clientWidth/h.w,j=d.clientHeight/h.h,f=f*e.cols|0,j=j*e.rows|0,c.resize(f,j),d.style.width="",d.style.height="",d.style.overflow="",d.style.opacity="",d.style.cursor="",g.style.cursor="",e.element.style.height="",i.off(document,"mousemove",a),i.off(document,"mouseup",b)}var c=this,d=this.element,e=this.focused,f=this.tty,g=f.root;this.minimize&&delete this.minimize;var h={w:d.clientWidth,h:d.clientHeight};d.style.overflow="hidden",d.style.opacity="0.70",d.style.cursor="se-resize",g.style.cursor="se-resize",e.element.style.height="100%",i.on(document,"mousemove",a),i.on(document,"mouseup",b)},d.prototype.maximize=function(){if(this.minimize)return this.minimize();var a,b,c=this,d=this.element,e=this.focused,f=this.tty,g=f.root,h={cols:e.cols,rows:e.rows,left:d.offsetLeft,top:d.offsetTop,root:g.className};this.minimize=function(){delete this.minimize,d.style.left=h.left+"px",d.style.top=h.top+"px",d.style.width="",d.style.height="",e.element.style.width="",e.element.style.height="",d.style.boxSizing="",c.grip.style.display="",g.className=h.root,c.resize(h.cols,h.rows),c.emit("minimize")},window.scrollTo(0,0),a=g.clientWidth/e.element.offsetWidth,b=g.clientHeight/e.element.offsetHeight,a=a*e.cols|0,b=b*e.rows|0,d.style.left="0px",d.style.top="0px",d.style.width="100%",d.style.height="100%",e.element.style.width="100%",e.element.style.height="100%",d.style.boxSizing="border-box",this.grip.style.display="none",g.className="maximized",this.resize(a,b),this.emit("maximize")},d.prototype.resize=function(a,b){this.cols=a,this.rows=b,this.each(function(c){c.resize(a,b)}),this.emit("resize",a,b)},d.prototype.each=function(a){for(var b=this.tabs.length;b--;)a(this.tabs[b],b)},d.prototype.createTab=function(a){var b=this,c=new k["default"](this,this.socket,a);return this.bar.appendChild(c.button),c.id&&this.tabs.set(c.id,c),c.on("process",function(a){b.focused===c&&(b.window.title.innerHTML=a)}),c.on("open",function(){b.tabs.set(c.id,c),b.emit("open tab",c)}),c},d.prototype.highlight=function(){var a=this;this.element.style.borderColor="orange",setTimeout(function(){a.element.style.borderColor=""},200),this.focus()},d.prototype.focusTab=function(a){var b=this.title,c=this.element;this.focused&&this.focused!==a&&(this.focused.unfocus(),c.removeChild(this.focused.element)),this.focused||(c.appendChild(a.element),this.focused=a),b.innerHTML=a.process,this.focus()},d.prototype.nextTab=function(){var a,b,c=this.tabs,d=this.focused;c.forEach(function(c){b||(b=c),a&&a===d&&(b=c),a=c}),b&&b.focus()},d.prototype.previousTab=function(){var a,b,c=this.tabs,d=this.focused;c.forEach(function(c){c===d&&a&&(b=a),a=c}),b?b.focus():a&&a.focus()},d.prototype.removeTab=function(a){this.tabs.has(a.id)&&this.tabs["delete"](a.id),this.focused===a&&this.previousTab(),this.tabs.size||this.syncing||this.destroy()},d.prototype.write=function(a,b){this.tabs.has(a)&&this.tabs.get(a).write(b)},d.prototype.kill=function(a){this.tabs.has(a)&&this.tabs.get(a).destroy()},d.prototype.sync=function(a){var b,c=this;this.syncing=!0,this.tabs.forEach(function(a){a._destroy()}),this.tabs.clear(),g(a).forEach(function(d){var e=a[d],f=c.createTab(e);b||(b=f)}),this.syncing=!1,this.emit("sync",this),b&&b.focus()},c["default"]=d,b.exports=c["default"]},{"./tab":45,"./utils":47,"babel-runtime/core-js/map":1,"babel-runtime/core-js/object/define-property":3,"babel-runtime/core-js/object/keys":5,"babel-runtime/helpers/interop-require-default":10}]},{},[44])(44)});
//# sourceMappingURL=tty.min.js.map